<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        <meta name="author" content="ZhangShengli">
        <link rel="canonical" href="https://imshengli.com/wiki/es6/basic/basic/">
        <link rel="shortcut icon" href="../../../../favicon.png">
        

	<title>语法 - ES6</title>

        <link href="../../css/bootstrap-custom.min.css" rel="stylesheet">
        <link href="../../css/font-awesome-4.0.3.css" rel="stylesheet">
        <link href="../../css/base.css" rel="stylesheet">
        <link rel="stylesheet" href="../../css/highlight.css">
        <link href="../../css/basic.css" rel="stylesheet">

        <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->

        
    </head>

    <body>

        <div class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">

        <!-- Collapsed navigation -->
        <div class="navbar-header">
            
            <!-- Expander button -->
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            

            <!-- Main title -->
            <a class="navbar-brand" href="../..">ES6</a>
        </div>

        <!-- Expanded navigation -->
        <div class="navbar-collapse collapse">
            
                <!-- Main navigation -->
                <ul class="nav navbar-nav">
                
                
                    <li >
                        <a href="../..">主页</a>
                    </li>
                
                
                
                    <li class="dropdown active">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">基础知识 <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                        
                            
<li class="active">
    <a href="./">语法</a>
</li>

                        
                            
<li >
    <a href="../class/">Class</a>
</li>

                        
                            
<li >
    <a href="../symbol/">Symbol</a>
</li>

                        
                        </ul>
                    </li>
                
                
                
                    <li >
                        <a href="../../about/">关于</a>
                    </li>
                
                
                </ul>
            

            <ul class="nav navbar-nav navbar-right">
                <li>
                    <a href="#" data-toggle="modal" data-target="#mkdocs_search_modal">
                        <i class="fa fa-search"></i> Search
                    </a>
                </li>
                
                    <li >
                        <a rel="next" href="../..">
                            <i class="fa fa-arrow-left"></i> Previous
                        </a>
                    </li>
                    <li >
                        <a rel="prev" href="../class/">
                            Next <i class="fa fa-arrow-right"></i>
                        </a>
                    </li>
                
                
                    <li>
                        <a href="https://github.com/shengli0218/wiki/">
                            
                                <i class="fa fa-github"></i>
                            
                            GitHub
                        </a>
                    </li>
                
            </ul>
        </div>
    </div>
</div>

        <div class="container">
            
                <div class="col-md-3"><div class="bs-sidebar hidden-print affix well" role="complementary">
    <ul class="nav bs-sidenav">
    
        <li class="main active"><a href="#es6">ES6 基础知识</a></li>
        
            <li><a href="#1-let">1. let 命令</a></li>
        
            <li><a href="#2">2. 块级作用域</a></li>
        
            <li><a href="#3-const">3. const 命令</a></li>
        
            <li><a href="#4">4. 跨模块常量</a></li>
        
            <li><a href="#5">5. 全局对象的属性</a></li>
        
    
    </ul>
</div></div>
                <div class="col-md-9" role="main">

<h2 id="es6">ES6 基础知识</h2>
<hr>

<h3 id="1-let">1. let 命令</h3>
<p>（1）ES6新增了<code>let</code>命令，类似与<code>var</code>，但 let 声明的变量，只在 let 命令所在的代码块中使用；例如：</p>
<pre><code>{
    let a = 1;
    var b = 2;
}
a; // ReferenceError: a is not defined
b; // 2
</code></pre>

<p>let 定义变量很适合在<code>for</code>语句中使用；</p>
<p>（2）let 不会发生“变量提升”，使用之前应先定义；</p>
<pre><code>console.log(foo); // ReferenceError
let foo = 2;
</code></pre>

<p>（3）TDZ：temporal dead zone，暂时性死区；</p>
<p>只要块级作用域内存在let命令，它所声明的变量就“绑定”（binding）这个区域，不再受外部的影响。</p>
<pre><code>var tmp = 123;
if (true) {
  tmp = 'abc'; // ReferenceError
  let tmp;
}
</code></pre>

<p>总之，暂时性死区的本质就是，只要一进入当前作用域，所要使用的变量就已经存在了，但是不可获取，只有等到声明变量的那一行代码出现，才可以获取和使用该变量。</p>
<p>ES6规定暂时性死区和不存在变量提升，主要是为了减少运行时错误，防止在变量声明前就使用这个变量，从而导致意料之外的行为。</p>
<p>（4）不允许重复声明</p>
<p>let不允许在相同作用域内，重复声明同一个变量。</p>
<pre><code>function func(arg) {
  let arg; // 报错
}

function func(arg) {
  {
    let arg; // 不报错
  }
}
</code></pre>

<h3 id="2">2. 块级作用域</h3>
<p>（1） <code>let</code>实际上为JavaScript新增了块级作用域；外层作用域无法读取内层作用域的变量；内层作用域可以定义外层作用域的同名变量；块级作用域的出现，实际上使得获得广泛应用的立即执行匿名函数（IIFE）不再必要了。</p>
<pre><code>function f1() {
  let n = 5;
  if (true) {
    let n = 10;
  }
  console.log(n); // 5
}
</code></pre>

<p>（2）另外，ES6也规定，函数本身的作用域，在其所在的块级作用域之内。</p>
<pre><code>function f() { console.log('I am outside!'); }
(function () {
  if(false) {
    // 重复声明一次函数f
    function f() { console.log('I am inside!'); }
  }
  f(); //  输出为：I am outside!
}());
</code></pre>

<p>需要注意的是，如果在严格模式下，函数只能在顶层作用域和函数内声明，其他情况（比如if代码块、循环代码块）的声明都会报错。</p>
<h3 id="3-const">3. const 命令</h3>
<p>（1）const也用来声明变量，但是声明的是常量。一旦声明，常量的值就不能改变；这意味着，const一旦声明变量，就必须立即初始化，不能留到以后赋值。</p>
<pre><code>const PI = 3.1415;
PI // 3.1415
PI = 3; // TypeError: &quot;PI&quot; is read-only
</code></pre>

<p>（2）const的作用域与let命令相同：只在声明所在的块级作用域内有效；const命令声明的常量也是不提升，同样存在暂时性死区，只能在声明的位置后面使用；同样不可重复声明；</p>
<p>（3）对于复合类型的变量，变量名不指向数据，而是指向数据所在的地址。const命令只是保证变量名指向的地址不变，并不保证该地址的数据不变，所以将一个对象声明为常量必须非常小心。</p>
<pre><code>const foo = {};
foo.prop = 123;

foo.prop
// 123

foo = {} // TypeError: &quot;foo&quot; is read-only不起作用
</code></pre>

<p>对于数组同样如此：</p>
<pre><code>const a = [];
a.push(&quot;Hello&quot;); // 可执行
a.length = 0;    // 可执行
a = [&quot;Dave&quot;];    // 报错
</code></pre>

<p>如果真的想将对象冻结，应该使用Object.freeze方法。</p>
<pre><code>const foo = Object.freeze({});
foo.prop = 123; // 不起作用
</code></pre>

<p>除了将对象本身冻结，对象的属性也应该冻结。下面是一个将对象彻底冻结的函数。</p>
<pre><code>var constantize = (obj) =&gt; {
    Object.freeze(obj);
    Object.keys(obj).forEach( (key, value) =&gt; {
        if ( typeof obj[key] === 'object' ) {
            constantize( obj[key] );
        }
    });
};
</code></pre>

<p>ES5只有两种声明变量的方法：var命令和function命令。ES6除了添加let和const命令，后面章节还会提到，另外两种声明变量的方法：import命令和class命令。所以，ES6一共有6种声明变量的方法。</p>
<h3 id="4">4. 跨模块常量</h3>
<p>上面说过，const声明的常量只在当前代码块有效。如果想设置跨模块的常量，可以采用下面的写法。</p>
<pre><code>// constants.js 模块
export const A = 1;
export const B = 3;
export const C = 4;

// test1.js 模块
import * as constants from './constants';
console.log(constants.A); // 1
console.log(constants.B); // 3

// test2.js 模块
import {A, B} from './constants';
console.log(A); // 1
console.log(B); // 3
</code></pre>

<h3 id="5">5. 全局对象的属性</h3>
<p>全局对象是最顶层的对象，在浏览器环境指的是window象，在Node.js指的是global对象。ES5之中，全局对象的属性与全局变量是等价的。</p>
<pre><code>window.a = 1;
a // 1

a = 2;
window.a // 2
</code></pre>

<p>上面代码中，全局对象的属性赋值与全局变量的赋值，是同一件事。（对于Node来说，这一条只对REPL环境适用，模块环境之中，全局变量必须显式声明成global对象的属性。）</p>
<p>这种规定被视为JavaScript语言的一大问题，因为很容易不知不觉就创建了全局变量。ES6为了改变这一点，一方面规定，var命令和function命令声明的全局变量，依旧是全局对象的属性；另一方面规定，let命令、const命令、class命令声明的全局变量，不属于全局对象的属性。</p>
<pre><code>var a = 1;
// 如果在Node的REPL环境，可以写成global.a
// 或者采用通用方法，写成this.a
window.a // 1

let b = 1;
window.b // undefined
</code></pre>

<p>上面代码中，全局变量a由var命令声明，所以它是全局对象的属性；全局变量b由let命令声明，所以它不是全局对象的属性，返回undefined。</p></div>
            
        </div>

        <footer class="col-md-12">
            <hr>
            
                <p>2012-2015&nbsp;&copy;&nbsp;IMSHENGLI.COM ALL RIGHTS RESERVED.</p>
            
            <p>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>

        <script src="../../js/jquery-1.10.2.min.js"></script>
        <script src="../../js/bootstrap-3.0.3.min.js"></script>
        <script src="../../js/highlight.pack.js"></script>
        <script>var base_url = '../..';</script>
        <script data-main="../../mkdocs/js/search.js" src="../../mkdocs/js/require.js"></script>
        <script src="../../js/base.js"></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="Search Modal" aria-hidden="true">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                        <h4 class="modal-title" id="exampleModalLabel">Search</h4>
                    </div>
                    <div class="modal-body">
                        <p>
                            From here you can search these documents. Enter
                            your search terms below.
                        </p>
                        <form role="form">
                            <div class="form-group">
                                <input type="text" class="form-control" placeholder="Search..." id="mkdocs-search-query">
                            </div>
                        </form>
                        <div id="mkdocs-search-results"></div>
                    </div>
                    <div class="modal-footer">
                    </div>
                </div>
            </div>
        </div>

    </body>
</html>
